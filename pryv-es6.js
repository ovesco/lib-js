var Pryv=function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){const r=/(.+):\/\/(.+)@(.+)/gm,s=/(.+):\/\/(.+)/gm,o={superagent:n(13),isBrowser:function(){return"undefined"!=typeof window&&"undefined"!=typeof document},extractTokenAndApiEndpoint:function(t){r.lastIndex=0;const e=r.exec(t);if(null!==e)return e[3].endsWith("/")||(e[3]+="/"),{endpoint:e[1]+"://"+e[3],token:e[2]};s.lastIndex=0;const n=s.exec(t);if(null===n)throw new Error("Cannot find endpoint, invalid URL format");return n[2].endsWith("/")||(n[2]+="/"),{endpoint:n[1]+"://"+n[2],token:null}},buildPryvApiEndpoint:function(t){if(!t.token){let e=t.endpoint+"";return t.endpoint.endsWith("/")||(e+="/"),e}s.lastIndex=0;let e=s.exec(t.endpoint);return e[2].endsWith("/")||(e[2]+="/"),e[1]+"://"+t.token+"@"+e[2]},browserIsMobileOrTablet:function(t){if(null==t)return!1;let e=!1;var n;return n=t.userAgent||t.vendor||t.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0),e},cleanURLFromPrYvParams:function(t){return t.replace(/[?#&]+prYv([^=&]+)=([^&]*)/g,"")},getQueryParamsFromURL:function(t){let e={};return t.replace(/[?#&]+([^=&]+)=([^&]*)/g,(function(t,n,r){e[n]=decodeURIComponent(r)})),e}};t.exports=o},function(t,e,n){const r=n(0),s=n(20);class o{constructor(t,e){this._pryvServiceInfo=null,this._assets=null,this._polling=!1,this._pryvServiceInfoUrl=t,this._pryvServiceCustomizations=e}async info(t){if(t||!this._pryvServiceInfo){let t={};if(this._pryvServiceInfoUrl){t=(await r.superagent.get(this._pryvServiceInfoUrl).set("Access-Control-Allow-Origin","*").set("accept","json")).body}Object.assign(t,this._pryvServiceCustomizations),this.setServiceInfo(t)}return this._pryvServiceInfo}setServiceInfo(t){if(!t.name)throw new Error("Invalid data from service/info");["access","api","register"].forEach(e=>{"/"!==t[e].slice(-1)&&(t[e]+="/")}),this._pryvServiceInfo=t}async assets(t){if(!t&&this._assets)return this._assets;{const t=await this.info();return t.assets&&t.assets.definitions?(this._assets=await s.setup(t.assets.definitions),this._assets):(console.log("Warning: no assets for this service"),null)}}infoSync(){return this._pryvServiceInfo}async apiEndpointFor(t,e){const n=await this.info();return o.buildAPIEndpoint(n,t,e)}static buildAPIEndpoint(t,e,n){const s=t.api.replace("{username}",e);return r.buildPryvApiEndpoint({endpoint:s,token:n})}async login(t,e,n,s){const a=await this.apiEndpointFor(t);try{const u={accept:"json"};s=s||(await this.info()).register,r.isBrowser()||(u.Origin=s);const c=await r.superagent.post(a+"auth/login").set(u).send({username:t,password:e,appId:n});if(!c.body.token)throw new Error("Invalid login response: "+c.body);return new i(o.buildAPIEndpoint(await this.info(),t,c.body.token),this)}catch(t){if(t.response&&t.response.body&&t.response.body.error&&t.response.body.error.message)throw new Error(t.response.body.error.message)}}}t.exports=o;const i=n(4)},function(t,e){t.exports={ERROR:"ERROR",LOADING:"LOADING",INITIALIZED:"INITIALIZED",NEED_SIGNIN:"NEED_SIGNIN",AUTHORIZED:"ACCEPTED",SIGNOUT:"SIGNOUT",REFUSED:"REFUSED"}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return null!==t&&"object"===r(t)}},function(t,e,n){const r=n(0),s=n(21),o=n(22);t.exports=class{constructor(t,e){const{token:n,endpoint:s}=r.extractTokenAndApiEndpoint(t);if(this.token=n,this.endpoint=s,this.options={},this.options.chunkSize=1e3,this._deltaTime={value:0,weight:0},!e instanceof i)throw new Error("Invalid service param");this._service=e}get service(){return this._service||(this._service=new i(this.endpoint+"service/info")),this._service}async username(){return(await this.accessInfo()).user.username}async accessInfo(){return this.get("access-info",null)}async api(t,e){return await this._chunkedBatchCall(t,e,function(t){return this.post("",t)}.bind(this))}async _chunkedBatchCall(t,e,n){if(!Array.isArray(t))throw new Error("Pryv.api() takes an array as input");const r=[];let s=0;for(let o=0;t.length>=o;o+=this.options.chunkSize){const i=[],a=Math.min(o+this.options.chunkSize,t.length);for(let e=o;e<a;e++)i.push({method:t[e].method,params:t[e].params});const u=await n(i);if(!u||!Array.isArray(u.results))throw new Error("API call result is not an Array: "+JSON.stringify(u));if(u.results.length!=i.length)throw new Error("API call result Array does not match request: "+JSON.stringify(u));for(let e=0;e<u.results.length;e++)t[e+o].handleResult&&await t[e+o].handleResult.call(null,u.results[e]);Array.prototype.push.apply(r,u.results),s=Math.round(100*r.length/t.length),e&&e(s,r)}return r}async post(t,e,n){const r=Date.now()/1e3,s=await this.postRaw(t,e,n);return this._handleMeta(s.body,r),s.body}async postRaw(t,e,n){return this._post(t).query(n).send(e)}_post(t){return r.superagent.post(this.endpoint+t).set("Authorization",this.token).set("accept","json")}async get(t,e){const n=Date.now()/1e3,r=await this.getRaw(t,e);return this._handleMeta(r.body,n),r.body}getRaw(t,e){return t=t||"",r.superagent.get(this.endpoint+t).set("Authorization",this.token).set("accept","json").query(e)}async addPointsToHFEvent(t,e,n){const r=await this.post("events/"+t+"/series",{format:"flatJSON",fields:e,points:n});if("ok"===!r.status)throw new Error("Failed loading serie: "+JSON.stringify(r.status));return r}async getEventsStreamed(t,e){const n=s(e,t.includeDeletions);let r=null;"undefined"==typeof window?r=await this.getRaw("events",t).buffer(!1).parse(n):"undefined"!=typeof fetch?r=await o(this,t,n):(console.log("WARNING: Browser does not support fetch() required by Pryv.Connection.getEventsStreamed()"),r=await this.getRaw("events",t),r.body.eventsCount=0,r.body.events&&(r.body.events.forEach(e),r.body.eventsCount+=r.body.events.length,delete r.body.events),r.body.eventDeletions&&(r.body.eventDeletions.forEach(e),r.body.eventsCount+=r.body.eventDeletions.length,delete r.body.eventDeletions));const i=Date.now()/1e3;return this._handleMeta(r.body,i),r.body}async createEventWithFile(t,e){const n=await this._post("events").field("event",JSON.stringify(t)).attach("file",e),r=Date.now()/1e3;return this._handleMeta(n.body,r),n.body}async createEventWithFormData(t,e){e.append("event",JSON.stringify(t));return(await this._post("events").send(e)).body}get deltaTime(){return this._deltaTime.value}get apiEndpoint(){return r.buildPryvApiEndpoint(this)}_handleMeta(t,e){if(!t.meta)throw new Error("Cannot find .meta in response.");if(!t.meta.serverTime)throw new Error("Cannot find .meta.serverTime in response.");this._deltaTime.value=(this._deltaTime.value*this._deltaTime.weight+t.meta.serverTime-e)/++this._deltaTime.weight}};const i=n(1)},function(t,e,n){const r=n(6),s=n(2),o=n(8),i=n(1);t.exports={setupAuth:async function(t,e,n,r=o){const s=new i(e,n);await s.info();const a=new r(t,s);return await a.init(),s},AuthStates:s,AuthController:r}},function(t,e,n){const r=n(0),s=(n(1),n(2)),o=n(7);t.exports=class{constructor(t,e,n){this.settings=t,function(t){if(!t)throw new Error("settings cannot be null");if(!t.authRequest)throw new Error("Missing settings.authRequest");if(t.authRequest.returnURL=this.getReturnURL(t.authRequest.returnURL),!t.authRequest.requestingAppId)throw new Error("Missing settings.authRequest.requestingAppId");if(!t.authRequest.requestedPermissions)throw new Error("Missing settings.authRequest.requestedPermissions")}.call(this,t),this.stateChangeListeners=[],this.settings.onStateChange&&this.stateChangeListeners.push(this.settings.onStateChange),this.service=e,this.languageCode=this.settings.authRequest.languageCode||"en",this.messages=o(this.languageCode),this.loginButton=n}async init(){this.serviceInfo=this.service.infoSync(),this.state={status:s.LOADING},this.assets=await async function(t){let e={};try{if(e=await t.service.assets(),"undefined"!=typeof location){await e.loginButtonLoadCSS();const n=await e.loginButtonGetMessages();n.LOADING?t.messages=o(t.languageCode,n):console.log("WARNING Messages cannot be loaded using defaults: ",n)}}catch(e){throw t.state={status:s.ERROR,message:"Cannot fetch button visuals",error:e},e}return e}(this);const t=this.loginButton;return null!=t&&(this.stateChangeListeners.push(t.onStateChange.bind(t)),await async function(t){const e=t.loginButton;if(null==e)return;const n=await e.getAuthorizationData();null!=n&&(t.state=Object.assign({},{status:s.AUTHORIZED},n))}(this)),this.state.status!=s.AUTHORIZED&&(this.state={status:s.INITIALIZED,serviceInfo:this.serviceInfo}),null!=t&&null!=t.finishAuthProcessAfterRedirection&&await t.finishAuthProcessAfterRedirection(this),this.service}stopAuthRequest(t){this.state={status:s.ERROR,message:t}}async handleClick(){!function(){return this.state.status==s.AUTHORIZED}.call(this)?!function(){return this.state.status===s.INITIALIZED}.call(this)?!function(){return this.state.status===s.NEED_SIGNIN}.call(this)?console.log('Unhandled action in "handleClick()" for status:',this.state.status):this.state=this.state:this.startAuthRequest():this.state={status:s.SIGNOUT}}getReturnURL(t,e,n){let s=(t=t||"auto#").slice(-1);if("#&?".indexOf(s)<0)throw new Error('Pryv access: Last character of --returnURL setting-- is not "?", "&" or "#": '+t);if(o(t)&&!r.browserIsMobileOrTablet(n))return!1;if(o(t)&&r.browserIsMobileOrTablet(n)||0===t.indexOf("self")){t=(e||window.location.href)+t.substring(4)}return r.cleanURLFromPrYvParams(t);function o(t){return 0===t.indexOf("auto")}}async startAuthRequest(){this.state=await async function(){try{return(await r.superagent.post(this.serviceInfo.access).send(this.settings.authRequest)).body}catch(t){throw this.state={status:s.ERROR,message:"Requesting access",error:t},t}}.call(this),await async function t(){if(this.state.status!==s.NEED_SIGNIN)return;const e=await async function(t){try{return(await r.superagent.get(t)).body}catch(t){return t.response&&403===t.response.status&&t.response.body&&"REFUSED"===t.response.body.status?{status:s.INITIALIZED}:{status:s.ERROR,message:"Error while polling for auth request",error:t}}}(this.state.poll);e.status===s.NEED_SIGNIN?setTimeout(await t.bind(this),this.state.poll_rate_ms):this.state=e}.call(this)}set state(t){t.id=t.status,this._state=t,this.stateChangeListeners.map(t=>{try{t(this.state)}catch(t){console.log("Error during set state ()",t)}})}get state(){return this._state}}},function(t,e){const n={LOADING:{en:"..."},ERROR:{en:"Error",fr:"Erreur"},LOGIN:{en:"Signin",fr:"Login"},SIGNOUT_CONFIRM:{en:"Logout ?",fr:"Se deconnecter ?"}};t.exports=function(t,e){const r=e||n,s={};return Object.keys(r).map(e=>{s[e]=r[e][t]||r[e].en}),s}},function(t,e,n){const r=n(9),s=n(2),o=n(6),i=(n(1),n(7)),a=n(0);t.exports=class{constructor(t,e){this.authSettings=t,this.service=e,this.serviceInfo=e.infoSync()}async init(){var t;return(t=this).loginButtonSpan=document.getElementById(t.authSettings.spanButtonID),t.loginButtonSpan?(t.loginButtonText=t.loginButtonSpan,t.loginButtonSpan.addEventListener("click",t.onClick.bind(t))):console.log("WARNING: Pryv.Browser initialized with no spanButtonID"),this.languageCode=this.authSettings.authRequest.languageCode||"en",this.messages=i(this.languageCode),this.loginButtonText&&await async function(t){const e=await t.service.assets();t.loginButtonSpan.innerHTML=await e.loginButtonGetHTML(),t.loginButtonText=document.getElementById("pryv-access-btn-text")}(this),this._cookieKey="pryv-libjs-"+this.authSettings.authRequest.requestingAppId,this.auth=new o(this.authSettings,this.service,this),await this.auth.init(),this.service}onClick(){this.auth.handleClick()}async onStateChange(t){switch(t.status){case s.LOADING:this.text=this.messages.LOADING;break;case s.INITIALIZED:this.text=function(t,e){return t.messages.LOGIN+": "+e}(this,this.serviceInfo.name);break;case s.NEED_SIGNIN:const e=t.authUrl||t.url;if(this.authSettings.authRequest.returnURL)return void(location.href=e);!async function(t,e){let n=void 0!==window.screenX?window.screenX:window.screenLeft,r=void 0!==window.screenY?window.screenY:window.screenTop,s=void 0!==window.outerWidth?window.outerWidth:document.body.clientWidth,o=void 0!==window.outerHeight?window.outerHeight:document.body.clientHeight-22,i=parseInt(n+(s-400)/2,10),a=parseInt(r+(o-620)/2.5,10),u="width=400,height=620,left="+i+",top="+a+",scrollbars=yes";t.popup=window.open(e,"prYv Sign-in",u),t.popup?window.focus&&t.popup.focus():t.auth.stopAuthRequest("FAILED_TO_OPEN_WINDOW")}(this,e);break;case s.AUTHORIZED:this.text=t.username,this.saveAuthorizationData({apiEndpoint:t.apiEndpoint,username:t.username});break;case s.SIGNOUT:const n=this.messages.SIGNOUT_CONFIRM?this.messages.SIGNOUT_CONFIRM:"Logout ?";confirm(n)&&(this.deleteAuthorizationData(),this.auth.init());break;case s.ERROR:this.text=function(t,e){return t.messages.ERROR+": "+e}(this,t.message);break;default:console.log("WARNING Unhandled state for Login: "+t.status)}this.loginButtonText&&(this.loginButtonText.innerHTML=this.text)}getAuthorizationData(){return r.get(this._cookieKey)}saveAuthorizationData(t){r.set(this._cookieKey,t)}async deleteAuthorizationData(){r.del(this._cookieKey)}async finishAuthProcessAfterRedirection(t){if(!a.isBrowser())return;let e=function(e){const n=a.getQueryParamsFromURL(e);let r=null;n.prYvkey&&(r=t.serviceInfo.access+n.prYvkey);n.prYvpoll&&(r=n.prYvpoll);return r}(window.location.href);if(null!==e)try{const n=await a.superagent.get(e);t.state=n.body}catch(e){t.state={status:s.ERROR,message:"Cannot fetch result",error:e}}}}},function(t,e,n){const r=n(0);function s(t,e,n){if(r.isBrowser()){n=n||365;var s=new Date,o=window.location.hostname,i=window.location.pathname;s.setDate(s.getDate()+n);var a=encodeURIComponent(t)+"="+encodeURIComponent(JSON.stringify(e))+";expires="+s.toGMTString()+";domain=."+o+";path="+i;n>=0&&(a+=";SameSite=Strict"),document.cookie=a}}e.set=s,e.get=function(t){const e=encodeURIComponent(t);if(r.isBrowser()){var n=("; "+document.cookie).split("; "+e+"=");return 2==n.length?JSON.parse(decodeURIComponent(n.pop().split(";").shift())):void 0}},e.del=function(t){s(t,{deleted:!0},-1)}},function(t,e,n){t.exports=n(11)},function(t,e,n){const r=n(12);t.exports=r},function(t,e,n){t.exports={Service:n(1),Connection:n(4),Auth:n(5),Browser:n(23),utils:n(0),version:n(24).version}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s;"undefined"!=typeof window?s=window:"undefined"==typeof self?(console.warn("Using browser-only version of superagent in non-browser environment"),s=void 0):s=self;var o=n(14),i=n(15),a=n(16),u=n(3),c=n(17),h=n(19);function l(){}t.exports=function(t,n){return"function"==typeof n?new e.Request("GET",t).end(n):1===arguments.length?new e.Request("GET",t):new e.Request(t,n)};var p=e=t.exports;e.Request=b,p.getXHR=function(){if(s.XMLHttpRequest&&(!s.location||"file:"!==s.location.protocol||!s.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw new Error("Browser-only version of superagent could not find XHR")};var d="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function f(t){if(!u(t))return t;var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&y(e,n,t[n]);return e.join("&")}function y(t,e,n){if(void 0!==n)if(null!==n)if(Array.isArray(n))n.forEach((function(n){y(t,e,n)}));else if(u(n))for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&y(t,"".concat(e,"[").concat(r,"]"),n[r]);else t.push(encodeURI(e)+"="+encodeURIComponent(n));else t.push(encodeURI(e))}function m(t){for(var e,n,r={},s=t.split("&"),o=0,i=s.length;o<i;++o)-1===(n=(e=s[o]).indexOf("="))?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function g(t){return/[/+]json($|[^-\w])/.test(t)}function w(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.headers=function(t){for(var e,n,r,s,o=t.split(/\r?\n/),i={},a=0,u=o.length;a<u;++a)-1!==(e=(n=o[a]).indexOf(":"))&&(r=n.slice(0,e).toLowerCase(),s=d(n.slice(e+1)),i[r]=s);return i}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function b(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",(function(){var t,e=null,r=null;try{r=new w(n)}catch(t){return(e=new Error("Parser is unable to parse the response")).parse=!0,e.original=t,n.xhr?(e.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",r);try{n._isResponseOK(r)||(t=new Error(r.statusText||r.text||"Unsuccessful HTTP response"))}catch(e){t=e}t?(t.original=e,t.response=r,t.status=r.status,n.callback(t,r)):n.callback(null,r)}))}function v(t,e,n){var r=p("DELETE",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}p.serializeObject=f,p.parseString=m,p.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},p.serialize={"application/x-www-form-urlencoded":f,"application/json":i},p.parse={"application/x-www-form-urlencoded":m,"application/json":JSON.parse},c(w.prototype),w.prototype._parseBody=function(t){var e=p.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&g(this.type)&&(e=p.parse["application/json"]),e&&t&&(t.length>0||t instanceof Object)?e(t):null)},w.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot ".concat(e," ").concat(n," (").concat(this.status,")"),s=new Error(r);return s.status=this.status,s.method=e,s.url=n,s},p.Response=w,o(b.prototype),a(b.prototype),b.prototype.type=function(t){return this.set("Content-Type",p.types[t]||t),this},b.prototype.accept=function(t){return this.set("Accept",p.types[t]||t),this},b.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"===r(e)&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});var s=function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(t,e,n,s)},b.prototype.query=function(t){return"string"!=typeof t&&(t=f(t)),t&&this._query.push(t),this},b.prototype.attach=function(t,e,n){if(e){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,n||e.name)}return this},b.prototype._getFormData=function(){return this._formData||(this._formData=new s.FormData),this._formData},b.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var n=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),n(t,e)},b.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},b.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},b.prototype.ca=b.prototype.agent,b.prototype.buffer=b.prototype.ca,b.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},b.prototype.pipe=b.prototype.write,b.prototype._isHost=function(t){return t&&"object"===r(t)&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},b.prototype.end=function(t){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||l,this._finalizeQueryString(),this._end()},b.prototype._setUploadTimeout=function(){var t=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((function(){t._timeoutError("Upload timeout of ",t._uploadTimeout,"ETIMEDOUT")}),this._uploadTimeout))},b.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var t=this;this.xhr=p.getXHR();var e=this.xhr,n=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var n=e.readyState;if(n>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4===n){var r;try{r=e.status}catch(t){r=0}if(!r){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var r=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(t._uploadTimeoutTimer)),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{e.addEventListener("progress",r.bind(null,"download")),e.upload&&e.upload.addEventListener("progress",r.bind(null,"upload"))}catch(t){}e.upload&&this._setUploadTimeout();try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof n&&!this._isHost(n)){var s=this._header["content-type"],o=this._serializer||p.serialize[s?s.split(";")[0]:""];!o&&g(s)&&(o=p.serialize["application/json"]),o&&(n=o(n))}for(var i in this.header)null!==this.header[i]&&Object.prototype.hasOwnProperty.call(this.header,i)&&e.setRequestHeader(i,this.header[i]);this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0===n?null:n)},p.agent=function(){return new h},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(t){h.prototype[t.toLowerCase()]=function(e,n){var r=new p.Request(t,e);return this._setDefaults(r),n&&r.end(n),r}})),h.prototype.del=h.prototype.delete,p.get=function(t,e,n){var r=p("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},p.head=function(t,e,n){var r=p("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},p.options=function(t,e,n){var r=p("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},p.del=v,p.delete=v,p.patch=function(t,e,n){var r=p("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},p.post=function(t,e,n){var r=p("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},p.put=function(t,e,n){var r=p("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<r.length;s++)if((n=r[s])===e||n.fn===e){r.splice(s,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var s=(n=n.slice(0)).length;r<s;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){t.exports=s,s.default=s,s.stable=i,s.stableStringify=i;var n=[],r=[];function s(t,e,s){var o;for(!function t(e,s,o,i){var a;if("object"==typeof e&&null!==e){for(a=0;a<o.length;a++)if(o[a]===e){var u=Object.getOwnPropertyDescriptor(i,s);return void(void 0!==u.get?u.configurable?(Object.defineProperty(i,s,{value:"[Circular]"}),n.push([i,s,e,u])):r.push([e,s]):(i[s]="[Circular]",n.push([i,s,e])))}if(o.push(e),Array.isArray(e))for(a=0;a<e.length;a++)t(e[a],a,o,e);else{var c=Object.keys(e);for(a=0;a<c.length;a++){var h=c[a];t(e[h],h,o,e)}}o.pop()}}(t,"",[],void 0),o=0===r.length?JSON.stringify(t,e,s):JSON.stringify(t,a(e),s);0!==n.length;){var i=n.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}return o}function o(t,e){return t<e?-1:t>e?1:0}function i(t,e,s){var i,u=function t(e,s,i,a){var u;if("object"==typeof e&&null!==e){for(u=0;u<i.length;u++)if(i[u]===e){var c=Object.getOwnPropertyDescriptor(a,s);return void(void 0!==c.get?c.configurable?(Object.defineProperty(a,s,{value:"[Circular]"}),n.push([a,s,e,c])):r.push([e,s]):(a[s]="[Circular]",n.push([a,s,e])))}if("function"==typeof e.toJSON)return;if(i.push(e),Array.isArray(e))for(u=0;u<e.length;u++)t(e[u],u,i,e);else{var h={},l=Object.keys(e).sort(o);for(u=0;u<l.length;u++){var p=l[u];t(e[p],p,i,e),h[p]=e[p]}if(void 0===a)return h;n.push([a,s,e]),a[s]=h}i.pop()}}(t,"",[],void 0)||t;for(i=0===r.length?JSON.stringify(u,e,s):JSON.stringify(u,a(e),s);0!==n.length;){var c=n.pop();4===c.length?Object.defineProperty(c[0],c[1],c[3]):c[0][c[1]]=c[2]}return i}function a(t){return t=void 0!==t?t:function(t,e){return e},function(e,n){if(r.length>0)for(var s=0;s<r.length;s++){var o=r[s];if(o[1]===e&&o[0]===n){n="[Circular]",r.splice(s,1);break}}return t.call(this,e,n)}}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=n(3);function o(t){if(t)return function(t){for(var e in o.prototype)Object.prototype.hasOwnProperty.call(o.prototype,e)&&(t[e]=o.prototype[e]);return t}(t)}t.exports=o,o.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},o.prototype.parse=function(t){return this._parser=t,this},o.prototype.responseType=function(t){return this._responseType=t,this},o.prototype.serialize=function(t){return this._serializer=t,this},o.prototype.timeout=function(t){if(!t||"object"!==r(t))return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this},o.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var i=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];o.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(t,e);if(!0===n)return!0;if(!1===n)return!1}catch(t){console.error(t)}if(e&&e.status&&e.status>=500&&501!==e.status)return!0;if(t){if(t.code&&i.includes(t.code))return!0;if(t.timeout&&"ECONNABORTED"===t.code)return!0;if(t.crossDomain)return!0}return!1},o.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},o.prototype.then=function(t,e){var n=this;if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((function(t,e){r.on("abort",(function(){if(!(n._maxRetries&&n._maxRetries>n._retries))if(n.timedout&&n.timedoutError)e(n.timedoutError);else{var t=new Error("Aborted");t.code="ABORTED",t.status=n.status,t.method=n.method,t.url=n.url,e(t)}})),r.end((function(n,r){n?e(n):t(r)}))}))}return this._fullfilledPromise.then(t,e)},o.prototype.catch=function(t){return this.then(void 0,t)},o.prototype.use=function(t){return t(this),this},o.prototype.ok=function(t){if("function"!=typeof t)throw new Error("Callback required");return this._okCallback=t,this},o.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},o.prototype.get=function(t){return this._header[t.toLowerCase()]},o.prototype.getHeader=o.prototype.get,o.prototype.set=function(t,e){if(s(t)){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},o.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},o.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(s(t)){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.field(n,t[n]);return this}if(Array.isArray(e)){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&this.field(t,e[r]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=String(e)),this._getFormData().append(t,e),this},o.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},o.prototype._auth=function(t,e,n,r){switch(n.type){case"basic":this.set("Authorization","Basic ".concat(r("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t))}return this},o.prototype.withCredentials=function(t){return void 0===t&&(t=!0),this._withCredentials=t,this},o.prototype.redirects=function(t){return this._maxRedirects=t,this},o.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw new TypeError("Invalid argument");return this._maxResponseSize=t,this},o.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},o.prototype.send=function(t){var e=s(t),n=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&s(this._data))for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(this._data[r]=t[r]);else"string"==typeof t?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"===n?this._data?"".concat(this._data,"&").concat(t):t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)||n||this.type("json"),this},o.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},o.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.includes("?")?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var n=this.url.slice(e+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.slice(0,e)+"?"+n.join("&")}}},o.prototype._appendQueryString=function(){console.warn("Unsupported")},o.prototype._timeoutError=function(t,e,n){if(!this._aborted){var r=new Error("".concat(t+e,"ms exceeded"));r.timeout=e,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)}},o.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout((function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")}),this._responseTimeout))}},function(t,e,n){"use strict";var r=n(18);function s(t){if(t)return function(t){for(var e in s.prototype)Object.prototype.hasOwnProperty.call(s.prototype,e)&&(t[e]=s.prototype[e]);return t}(t)}t.exports=s,s.prototype.get=function(t){return this.header[t.toLowerCase()]},s.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=r.type(e);var n=r.params(e);for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(this[s]=n[s]);this.links={};try{t.link&&(this.links=r.parseLinks(t.link))}catch(t){}},s.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=1===e,this.ok=2===e,this.redirect=3===e,this.clientError=4===e,this.serverError=5===e,this.error=(4===e||5===e)&&this.toError(),this.created=201===t,this.accepted=202===t,this.noContent=204===t,this.badRequest=400===t,this.unauthorized=401===t,this.notAcceptable=406===t,this.forbidden=403===t,this.notFound=404===t,this.unprocessableEntity=422===t}},function(t,e,n){"use strict";e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce((function(t,e){var n=e.split(/ *= */),r=n.shift(),s=n.shift();return r&&s&&(t[r]=s),t}),{})},e.parseLinks=function(t){return t.split(/ *, */).reduce((function(t,e){var n=e.split(/ *; */),r=n[0].slice(1,-1);return t[n[1].split(/ *= */)[1].slice(1,-1)]=r,t}),{})},e.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t}},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"].forEach((function(t){o.prototype[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this._defaults.push({fn:t,args:n}),this}})),o.prototype._setDefaults=function(t){this._defaults.forEach((function(e){t[e.fn].apply(t,r(e.args))}))},t.exports=o},function(t,e,n){const r=n(0);class s{constructor(t,e){this._assets=t,this._assetsURL=e}static async setup(t){const e=await r.superagent.get(t).set("accept","json");return new s(e.body,t)}get(t){let e=Object.assign({},this._assets);return t&&t.split(":").forEach(t=>{if(e=e[t],void 0===e)return e}),e}getUrl(t){const e=this.get(t);if("string"!=typeof e)throw new Error(e+" returned "+value);return this.relativeURL(e)}relativeURL(t){return function(t,e){var n=location;t&&((n=document.createElement("a")).href=t);for(var r,s,o="",i=n.pathname.replace(/[^\/]*$/,e.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),a=0;(s=i.indexOf("/../",a))>-1;a=s+r)r=/^\/(?:\.\.\/)*/.exec(i.slice(s))[0].length,o=(o+i.substring(a,s)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(r-1)/3+"}$"),"/");let u=n.port?":"+n.port:"";return n.protocol+"//"+n.hostname+u+o+i.substr(a)}(this._assets.baseUrl||this._assetsURL,t)}async setAllDefaults(){this.setFavicon(),await this.loadCSS()}setFavicon(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=this.relativeURL(this._assets.favicon.default.url),document.getElementsByTagName("head")[0].appendChild(t)}async loadCSS(){o(this.relativeURL(this._assets.css.default.url))}async loginButtonLoadCSS(){o(this.relativeURL(this._assets["lib-js"].buttonSignIn.css))}async loginButtonGetHTML(){return(await r.superagent.get(this.relativeURL(this._assets["lib-js"].buttonSignIn.html)).set("accept","html")).text}async loginButtonGetMessages(){return(await r.superagent.get(this.relativeURL(this._assets["lib-js"].buttonSignIn.messages)).set("accept","json")).body}}function o(t){var e=document.getElementsByTagName("head")[0],n=document.createElement("link");n.id=t,n.rel="stylesheet",n.type="text/css",n.href=t,n.media="all",e.appendChild(n)}t.exports=s},function(t,e){const n=['"events":[','"eventDeletions":['];t.exports=function(t,e){let r=0,s="",o=null,i=0,a=!1,u=!1,c=0,h=0,l=0;const p=0,d=1,f=2;let y=p;function m(){switch(y){case p:(t=s.indexOf(n[r]))>0&&(0===r&&(o=s.substring(0,t)),s=s.substr(t+n[r].length),y=d,g());break;case d:g();break;default:o+=s,s=""}var t}function g(){for(;c<s.length&&y===d;)if(u)u=!1,c++;else{switch(s.charCodeAt(c)){case 93:if(0===i){if(0!==c)throw new Error("Found trailling ] in mid-course");if(0===r&&e)return y=p,void(r=1);{y=f;let t="";1===r&&(t='"eventDeletionsCount":'+l+","),s=t+'"eventsCount":'+h+s.substr(1)}}break;case 92:u=!0;break;case 123:a||i++;break;case 34:a=!a;break;case 125:if(a||i--,0===i){const e=44===s.charCodeAt(0)?1:0,o=s.substring(e,c+1);0===r?h++:l++,s=s.substr(c+1),n=o,t(JSON.parse(n)),c=-1}}c++}var n}return function(t,e){t.setEncoding("utf8"),t.on("data",t=>{s+=t,m()}),t.on("end",()=>{let n,r;try{t.text=o+s,r=t.text&&JSON.parse(t.text)}catch(e){n=e,n.rawResponse=t.text||null,n.statusCode=t.statusCode}finally{e(n,r)}})}}},function(t,e){t.exports=async function(t,e,n){const r={ondata:null,onend:null,encoding:"utf8"},s={setEncoding:function(t){r.encoding=t},on:function(t,e){r["on"+t]=e}};let o,i;n(s,(function(t,e){o=t,i=e}));let a=new URL(t.endpoint+"events");a.search=new URLSearchParams(e);let u={method:"GET",headers:{Accept:"application/jon"}};t.token&&(u.headers.Authorization=t.token);let c=await fetch(a,u);const h=c.body.getReader();for(;;){const{done:t,value:e}=await h.read();if(r.ondata(new TextDecoder(r.encoding).decode(e)),t){r.onend();break}}if(o)throw new Error(o);const l={text:s.text,body:i,statusCode:c.status,headers:{}};for(var p of c.headers.entries())l.headers[p[0]]=p[1];return l}},function(t,e,n){const r=n(8),s=n(9),o=(n(1),n(0));t.exports={LoginButton:r,CookieUtils:s,AuthStates:n(2),setupAuth:n(5).setupAuth,serviceInfoFromUrl:function(t){return o.getQueryParamsFromURL(t||window.location.href).pryvServiceInfoUrl}}},function(t){t.exports=JSON.parse('{"name":"pryv","version":"2.1.1","homepage":"https://github.com/pryv/lib-js","description":"Pryv Javascript Library","keywords":["Pryv"],"repository":{"type":"git","url":"git://github.com/pryv/lib-js"},"bugs":{"url":"https://github.com/pryv/lib-js/issues"},"author":{"name":"Pryv S.A."},"main":"src/index.js","license":"BSD-3-Clause","scripts":{"setup":"./scripts/setup-environment-dev.sh","build":"webpack --config webpack.config.js","doc":"node node_modules/jsdoc/jsdoc.js -c .jsdoc-conf.json","test":"mocha --reporter spec  test/**/*.test.js --timeout 3000","test-debug":"mocha --inpect-brk=40000 --reporter spec  test/**/*.test.js ","test:browser":"npm run build; ","cover":"nyc npm run test && npm run cover:report","cover:report":"nyc report --reporter=lcov --reporter=html","webserver":"./node_modules/.bin/rec-la ./dist 9443","gh-pages":"./scripts/upload.sh","clear":"rm -r dist/ && npm run setup"},"contributors":[{"name":"Pierre-Mikael Legris","email":"perki@pryv.com"}],"dependencies":{"superagent":"^5.2.2"},"devDependencies":{"@pryv/lib-js-common":"git+https://github.com/pryv/lib-js-common.git#1.0.1","@pryv/monitor":"^1.0.0","@pryv/socket.io":"^1.0.1","chai":"^4.2.0","chai-as-promised":"^7.1.1","cuid":"^2.1.8","jsdoc":"^3.6.4","mocha":"^6.2.3","node-fetch":"^2.6.0","nyc":"^14.1.1","rec-la":"^0.1.16","universal-url":"^2.0.0","zombie":"^6.1.4"}}')}]);
//# sourceMappingURL=pryv-es6.js.map